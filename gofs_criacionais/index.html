<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    
    <link rel="shortcut icon" href="../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Módulo Padrões de Projeto GoFs Criacionais - Diário da Saúde</title>
    <link href="../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/highlight.css">
    <link href="../css/extra.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-3.2.1.min.js"></script>
    <script src="../js/bootstrap-3.3.7.min.js"></script>
    <script src="../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "GOF's Criacionais", url: "#_top", children: [
              {title: "Versionamento", url: "#versionamento" },
              {title: "Introdu\u00e7\u00e3o", url: "#introducao" },
              {title: "Factory Method", url: "#factory-method" },
              {title: "Refer\u00eancia", url: "#referencia" },
          ]},
        ];

    </script>
    <script src="../js/base.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../gofs_estruturais/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../gofs_estruturais/" class="btn btn-xs btn-link">
        Módulo Padrões de Projeto GoFs Estruturais
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../grasps/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../grasps/" class="btn btn-xs btn-link">
        Módulo Padrões de Projeto GRASPs
      </a>
    </div>
    
  </div>

    

    <h1 id="gofs-criacionais">GOF's Criacionais</h1>
<h2 id="versionamento">Versionamento</h2>
<table>
<thead>
<tr>
<th align="center">Data</th>
<th align="center">Versão</th>
<th align="center">Descrição</th>
<th align="center">Autor(es)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">22/10/2020</td>
<td align="center">0.1</td>
<td align="center">Criação do Documento</td>
<td align="center"><a href="https://github.com/murilo-dan">Murilo Loiola</a></td>
</tr>
<tr>
<td align="center">25/10/2020</td>
<td align="center">0.2</td>
<td align="center">Adição da Introdução</td>
<td align="center"><a href="https://github.com/Rdadamos">Rodrigo Dadamos</a></td>
</tr>
<tr>
<td align="center">26/10/2020</td>
<td align="center">0.3</td>
<td align="center">Adição do Factory Method com definição e motivação</td>
<td align="center"><a href="https://github.com/Rdadamos">Rodrigo Dadamos</a></td>
</tr>
<tr>
<td align="center">26/10/2020</td>
<td align="center">0.4</td>
<td align="center">Adição de Referências</td>
<td align="center"><a href="https://github.com/Rdadamos">Rodrigo Dadamos</a></td>
</tr>
<tr>
<td align="center">26/10/2020</td>
<td align="center">0.5</td>
<td align="center">Adição do tópico 'Aplicação'</td>
<td align="center"><a href="https://github.com/gustavocarvalho1002">Gustavo Carvalho</a></td>
</tr>
<tr>
<td align="center">26/10/2020</td>
<td align="center">0.6</td>
<td align="center">Adição dos trechos de código das classes de <i>Report</i>, <i>GroupReport</i> e <i>PatientReport</i></td>
<td align="center"><a href="https://github.com/gustavocarvalho1002">Gustavo Carvalho</a></td>
</tr>
<tr>
<td align="center">26/10/2020</td>
<td align="center">0.7</td>
<td align="center">Adição dos trechos de código das classes de <i>GroupReportPage</i>, <i>PatientReportPage</i> e <i>ReportPage</i></td>
<td align="center"><a href="https://github.com/gustavocarvalho1002">Gustavo Carvalho</a></td>
</tr>
<tr>
<td align="center">26/10/2020</td>
<td align="center">0.8</td>
<td align="center">Adição do diagrama de classes</td>
<td align="center"><a href="https://github.com/Rdadamos">Rodrigo Dadamos</a></td>
</tr>
<tr>
<td align="center">26/10/2020</td>
<td align="center">1.0</td>
<td align="center">Adição dos links dos códigos e revisão do documento</td>
<td align="center"><a href="https://github.com/gustavocarvalho1002">Gustavo Carvalho</a></td>
</tr>
</tbody>
</table>
<h2 id="introducao">Introdução</h2>
<p align="justify">&emsp;&emsp;De acordo com GAMMA et al. no livro <i>Design Patterns: Elements of Reusable Object-Oriented Software</i>, padrões de projeto são soluções consolidadas para um problema recorrente no desenvolvimento e manutenção de softwares orientados a objeto. A proposta é utilizar uma solução padronizada, consolidada, validada e testada pela comunidade para um problema recorrente ao longo do desenvolvimento e manutenção do software. Considerando o princípio de encapsulamento, a complexidade de um sistema deve ser isolada quando possível. Em um sistema orientado a objeto, a criação de objetos não é uma tarefa fácil e lida com dois principais problemas: definir qual classe concreta deve criar o objeto, e definir como os objetos se relacionam com outros objetos do sistema. Dessa maneira, os GOF's criacionais apontam soluções padronizadas para esses problemas. Os principais GOF's criacionais são:</p>

<ul>
<li>Factory Method;</li>
<li>Abstract Factory;</li>
<li>Builder;</li>
<li>Prototype;</li>
<li>Singleton;</li>
<li>Multiton;</li>
<li>Object Pool;</li>
</ul>
<h2 id="factory-method">Factory Method</h2>
<h4 id="definicao">Definição</h4>
<p align="justify">&emsp;&emsp;Quando instâncias de determinados objetos são muito requisitadas por outras classes de forma que a hierarquia de classes desses objetos (que já faz muitos cálculos, possuindo outras responsabilidades e ainda outras partes comportamentais) sofre muitas solicitações de criação de instâncias ficando sobrecarregada e gerando um gargalo, é indicado o uso de um padrão criacional. O padrão Factory Method é um padrão muito útil e muito recorrente que encapsula a hierarquia de classes escolhida para a criação de objetos permitindo delegar a instaciação de objetos para as classes filhas. O Factory Method delega a instaciação a uma outra hierarquia de classes, espelho da hierarquia de classes que está sendo o gargalo, mas dedicada somente a criação de instâncias. Dessa forma, a hierarquia de classes original fica livre para realizar suas outras responsabilidades. Como a intenção é minimizar o gargalo, testes devem ser feitos para verificar se o objetivo foi alcançado.</p>

<h4 id="motivacao">Motivação</h4>
<p align="justify">&emsp;&emsp;O Diário da Saúde permite tanto aos pacientes quanto aos profissionais de saúde gerarem relatórios. Esses relatórios possuem informações sobre o paciente e as respostas aos formulários aplicados em seus grupos. Os pacientes podem gerar somente relatórios individuais sobre eles mesmos, e os profissionais de saúde podem gerar relatórios individuais de pacientes pertencentes aos seus grupos de acompanhamento ou um relatório geral sobre um determinado grupo que ele acompanha. Dessa forma, há uma hierarquia de classes para o Relatório responsável pela instanciação de objetos nas classes filhas relatório individual e relatório do grupo, além de outras responsabilidades necessaŕias para a criação do relatórios, como consultas e outras partes comportamentais. Essa hierarquia é constantemente acessada e requisitada para criação de mais de um tipo de relatório pelas classes do Paciente e do Profissional de Saúde representando um possível gargalo para o sistema. O Factory Method, ao criar um espelho dessa hierarquia, delega a instaciação dos relatórios para essa hierarquia espelho que é dedicada somente a criação de instâncias.</p>

<h4 id="aplicacao-no-projeto">Aplicação no projeto</h4>
<p align="justify">&emsp;&emsp;Levando em consideração a motivação descrita acima, o padrão foi aplicado com o desenvolvimento de quatro papeis dentro do código:  criador base, criador especializado, produto abstrato e produto concreto. Para o produto abstrato nos temos a classe <i>Report</i>, que define o objeto base para as suas generalizações. Já as classes <i>GroupReport</i> e <i>PatientReport</i> fazem o papel dos produtos concretos, tendo como base a classe <i>Report</i>. Para os criadores foram implementados as classes GrouReportPage e PatientReportPage, que atuam na construção de relatórios de pacientes e grupos, onde essas classes são especializadas e derivam do criador base.</p>

<h4 id="diagrama">Diagrama</h4>
<p><a href="../img/factory-method.jpg"><img alt="composite_diagram" src="../img/factory-method.jpg" /></a></p>
<h4 id="codigo">Código</h4>
<ul>
<li><a href="https://github.com/UnBArqDsw/2020.1_G5_Diario_da_Saude/blob/master/backend/DiarioSaude/models/report.model.js">Report (produto abstrato)</a></li>
</ul>
<pre><code class="language-javascript">const mongoose = require('mongoose');
const Schema = mongoose.Schema;

const ReportSchema = new Schema({
  reportDate: {type: Date, required: true},
  reportDescription: {type: String, required: true},
});


class ReportClass{

  static getReportById(_id, callback){
    return this.findOne({_id:_id}, (err, report) =&gt; {
      if(err) throw err;

      callback(err, report)
    });
  }

}

ReportSchema.loadClass(ReportClass)

const ReportModel = mongoose.model('report', ReportSchema)

module.exports = {ReportClass, ReportSchema, ReportModel}
</code></pre>
<ul>
<li><a href="https://github.com/UnBArqDsw/2020.1_G5_Diario_da_Saude/blob/master/backend/DiarioSaude/models/groupReport.model.js">GroupReport (produto concreto)</a></li>
</ul>
<pre><code class="language-javascript">const mongoose = require('mongoose'),
  Schema = mongoose.Schema;
Report = require('./report.model.js')

var groupReportSchema = new Schema({
  groupId: [{ type: Schema.Types.ObjectId, ref: &quot;group&quot; }]
});

class GroupReport extends Report.ReportClass {

  static getPatientReportByGroupId(groupId, callback){
    return this.findOne({groupId:groupId}, (err, report) =&gt; {
      if(err) throw err;

      callback(err, report)
    });
  }

}

groupReportSchema.loadClass(GroupReport);

module.exports = Report.ReportModel.discriminator('groupReport', groupReportSchema);
</code></pre>
<ul>
<li><a href="https://github.com/UnBArqDsw/2020.1_G5_Diario_da_Saude/blob/master/backend/DiarioSaude/models/patientReport.model.js">PatientReport (produto concreto)</a></li>
</ul>
<pre><code class="language-javascript">const mongoose = require('mongoose'),
  Schema = mongoose.Schema;
Report = require('./report.model.js')

var patientReportSchema = new Schema({
  cpf:{type: Number, required: true}
});

class PatientReport extends Report.ReportClass {

  static getPatientReportByCPF(cpf, callback){
    return this.findOne({cpf:cpf}, (err, report) =&gt; {
      if(err) throw err;

      callback(err, report)
    });
  }

}

patientReportSchema.loadClass(PatientReport);

module.exports = Report.ReportModel.discriminator('patientReport', patientReportSchema);
</code></pre>
<ul>
<li><a href="https://github.com/UnBArqDsw/2020.1_G5_Diario_da_Saude/blob/master/backend/DiarioSaude/models/patientReportPage.model.js">PatientReportPage (Criador especializado)</a></li>
</ul>
<pre><code class="language-javascript">const PatientReport = require('../models/patientReport.model.js');
const ReportPage = require('./reportPage.js')

class PatientReportPage extends ReportPage{

    static createPatientReport(){
        var patientReport = PatientReport.getReportByDate(req.reportDate)
        return patientReport;
    }

}

module.exports = PatientReportPage;
</code></pre>
<ul>
<li><a href="https://github.com/UnBArqDsw/2020.1_G5_Diario_da_Saude/blob/master/backend/DiarioSaude/models/groupReportPage.model.js">GroupReportPage (Criador especializado)</a></li>
</ul>
<pre><code class="language-javascript">const GroupReport = require('../models/groupReport.model.js');
const ReportPage = require('./reportPage.js')

class GroupReportPage extends ReportPage{

    static createPatientReport(cpf){
        var groupReport = GroupReport.getPatientReportByCPF(cpf)
        return groupReport;
    }

}

module.exports = GroupReportPage;
</code></pre>
<ul>
<li><a href="https://github.com/UnBArqDsw/2020.1_G5_Diario_da_Saude/blob/master/backend/DiarioSaude/models/reportPage.model.js">ReportPage (Criador base)</a></li>
</ul>
<pre><code class="language-javascript">const Report = require('../models/report.model.js');

class ReportPage{

    static generateReport(){}

}

module.exports = PatientReportPage;
</code></pre>
<h2 id="referencia">Referência</h2>
<ol>
<li>Factory Method - dofactory. Disponível em: <a>https://www.dofactory.com/javascript/design-patterns/factory-method</a>. Acesso em: 25 Outubro 2020.</li>
<li>Factory Method Design Pattern - SourceMaking. Disponível em: <a>https://sourcemaking.com/design_patterns/factory_method</a>. Acesso em: 25 Outubro 2020.</li>
</ol>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../gofs_estruturais/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../gofs_estruturais/" class="btn btn-xs btn-link">
        Módulo Padrões de Projeto GoFs Estruturais
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../grasps/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../grasps/" class="btn btn-xs btn-link">
        Módulo Padrões de Projeto GRASPs
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="container-fluid wm-page-content">
      <p>
        <a href="https://github.com/UnBArqDsw/2020.1_G5_Diario_da_Saude/edit/master/docs/gofs_criacionais.md"><i class="fa fa-github"></i>
Edit on GitHub</a>
      </p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>